

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Eigen &mdash; zh794390558.github.io 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CUDA" href="cuda.html" />
    <link rel="prev" title="HPC" href="hpc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> zh794390558.github.io
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Hui Zhang</a></li>
</ul>
<p class="caption"><span class="caption-text">Speech</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../speech/asr/chinese_syllable.html">chinese syllable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/asr/alignment.html">Alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/asr/edit-distance-papers/README.html">ASR Edit-distance as objective function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/decode/decoding.html">Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/lm/ppl.html"><strong>语言模型评价指标Perplexity</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/lm/ngram_lm.html">Ngram LM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/tts/README.html">TTS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/tts/speech_synthesis.html">Speech Synthesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/tts/TTS-papers/README.html">TTS papers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/text_process/crf.html">CRF(Conditional Random Fields)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/text_process/asr_text_backend.html">ASR Text Backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/text_process/tts_text_frontend.html">Text Front End</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/vad/vad.html">VAD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/spk/README.html">Speaker Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/separation/README.html">Speech Separation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/io/README.html">Speech I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/io/praat_textgrid.html">Praat and TextGrid</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/training/speech_features.html">Speech Features</a></li>
</ul>
<p class="caption"><span class="caption-text">Coding</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cpp.html">library</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithm.html">Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Coding Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="aot/python_to_cpp.html">Python code to Cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_algebra.html">线性代数</a></li>
<li class="toctree-l1"><a class="reference internal" href="hpc.html">HPC</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Eigen</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">模块和头文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">一个简单的例子</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">例2： 矩阵和向量</a></li>
<li class="toctree-l2"><a class="reference internal" href="#matrix">Matrix类</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vectors">Vectors向量</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dynamic">Dynamic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">构造函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">获取元素</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">逗号初始化</a></li>
<li class="toctree-l2"><a class="reference internal" href="#resizing">resizing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#assignment-resizing">assignment 和 resizing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vs">固定尺寸 vs 动态尺寸</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id9">其他模板参数</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id10">一些方便的定义</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id11">矩阵和向量的运算</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id12">介绍</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id13">加减</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id14">标量乘法和除法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id15">表达式模板</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id16">转置和共轭</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id17">矩阵-矩阵的乘法和矩阵-向量的乘法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id18">点运算和叉运算</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id19">基础的归约操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id20">操作的有效性</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#array">Array类和元素级操作</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id21">为什么使用Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id22">Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id23">获取元素</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id24">加法和减法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id25">乘法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id26">其他元素级操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="#arraymatrix">array和matrix之间的转换</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id27">块操作</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id28">使用块</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id29">行和列</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id30">角相关操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id31">vectors的块操作</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id32">高级初始化方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id33">逗号初始化</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id34">特殊的矩阵和向量</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id35">功能函数</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id36">表达式变量</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id37">归约、迭代器和广播</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id38">归约</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id39">范数计算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id40">布尔归约</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id41">迭代器(遍历)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id42">部分归约</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id43">结合部分归约和其他操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id44">广播</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id45">结合广播和其他操作</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#map">原生缓存的接口：Map类</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id46">简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id47">Map类型</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id48">使用Map变量</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mapped">改变mapped数组</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reshape">Reshape</a></li>
<li class="toctree-l2"><a class="reference internal" href="#slicing">Slicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id49">混淆</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id50">例子</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id51">解决混淆问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="#component">混淆和component级的操作。</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id52">混淆和矩阵的乘法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id53">总结</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id54">存储顺序</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id55">存储顺序及选择</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id56">总结</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cuda.html">CUDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="simd.html">SIMD</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/tfrt.html">TFRT: A New TensorFlow Runtime </a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/docker.html">Develop with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/deltann_compile.html">Tensorflow compile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/adding_op.html">Adding Tensorflow Op</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/serving.html">Serving</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/tensorrt.html">TensorRT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/model_optimization.html">Model Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/contributing.html">Contributing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/version.html">Version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/ffmpeg.html">FFPMEG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/tools.html">Useful Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Production</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../product/product_value.html">用户体验、用户价值和产品价值</a></li>
</ul>
<p class="caption"><span class="caption-text">Dataset</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dataset.html">Dataset</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">zh794390558.github.io</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Eigen</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/coding/eigen.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="eigen">
<h1>Eigen<a class="headerlink" href="#eigen" title="Permalink to this headline">¶</a></h1>
<p>http://eigen.tuxfamily.org/dox/index.html</p>
<div class="section" id="id1">
<h2>简介<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Eigen是C++中可以用来调用并进行矩阵计算的一个库，简单了说它就是一个c++版本的matlab包。</p>
</div>
<div class="section" id="id2">
<h2>安装<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>下载eigen：http://eigen.tuxfamily.org/index.php?title=Main_Page#Download</p>
<p>Eigen只包含头文件，因此它不需要实现编译，只需要你include到你的项目，指定好Eigen的头文件路径，编译项目即可。而且跨平台，当然这是必须的。</p>
<p><strong>方案一</strong></p>
<p>下载后，解压得到文件夹中，Eigen子文件夹便是我们需要的全部；如果你想使用Eigen暂不支持的特性，可以使用unsupported子文件夹。可以把Eigen/unsupported复制到任何你需要的地方。</p>
<p><strong>方案二</strong></p>
<p>安装改包，其实就是把Eigen/unsupported的内容复制到“/usr/local/include/eigen3”下。在解压的文件夹下，新建build_dir，执行。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">cd</span> <span class="n">build_dir</span>
  <span class="n">cmake</span> <span class="o">../</span>
  <span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>详见INSTALL文件即可。</p>
</div>
<div class="section" id="id3">
<h2>模块和头文件<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Eigen库被分为一个Core模块和其他一些模块，每个模块有一些相应的头文件。 为了便于引用，Dense模块整合了一系列模块；Eigen模块整合了所有模块。一般情况下，<code class="docutils literal notranslate"><span class="pre">include&lt;Eigen/Dense&gt;</span></code> 就够了。</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Module</th>
<th>Header file</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td>Core</td>
<td>#include<Eigen/Core></td>
<td>Matrix和Array类，基础的线性代数运算和数组操作</td>
</tr>
<tr>
<td>Geometry</td>
<td>#include<Eigen/Geometry></td>
<td>旋转、平移、缩放、2维和3维的各种变换</td>
</tr>
<tr>
<td>LU</td>
<td>#include<Eigen/LU></td>
<td>求逆，行列式，LU分解</td>
</tr>
<tr>
<td>Cholesky</td>
<td>#include <Eigen/Cholesky></td>
<td>LLT和LDLT Cholesky分解</td>
</tr>
<tr>
<td>Householder</td>
<td>#include<Eigen/Householder></td>
<td>豪斯霍尔德变换，用于线性代数运算</td>
</tr>
<tr>
<td>SVD</td>
<td>#include<Eigen/SVD></td>
<td>SVD分解</td>
</tr>
<tr>
<td>QR</td>
<td>#include<Eigen/QR></td>
<td>QR分解</td>
</tr>
<tr>
<td>Eigenvalues</td>
<td>#include<Eigen/Eigenvalues></td>
<td>特征值，特征向量分解</td>
</tr>
<tr>
<td>Sparse</td>
<td>#include<Eigen/Sparse></td>
<td>稀疏矩阵的存储和一些基本的线性运算</td>
</tr>
<tr>
<td>稠密矩阵</td>
<td>#include<Eigen/Dense></td>
<td>包含了Core/Geometry/LU/Cholesky/SVD/QR/Eigenvalues模块</td>
</tr>
<tr>
<td>矩阵</td>
<td>#include<Eigen/Eigen></td>
<td>包括Dense和Sparse(整合库)</td>
</tr>
</tbody>
</table></div>
<div class="section" id="id4">
<h2>一个简单的例子<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="n">using</span> <span class="n">Eigen</span><span class="p">::</span><span class="n">MatrixXd</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">MatrixXd</span> <span class="n">m</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="n">m</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">;</span>
  <span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="n">m</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>编译并执行:<code class="docutils literal notranslate"><span class="pre">g++</span> <span class="pre">main.cpp</span> <span class="pre">-I</span> <span class="pre">/usr/local/include/eigen3/</span> <span class="pre">-o</span> <span class="pre">maincpp</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">3</span>  <span class="o">-</span><span class="mi">1</span>
<span class="mf">2.5</span> <span class="mf">1.5</span>
</pre></div>
</div>
<p>Eigen头文件定义了许多类型，所有的类型都在Eigen的命名空间内。MatrixXd代表的是任意大小（X*X）的矩阵，并且每个元素为double类型。</p>
</div>
<div class="section" id="id5">
<h2>例2： 矩阵和向量<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>再看另一个例子</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">MatrixXd</span> <span class="n">m</span> <span class="o">=</span> <span class="n">MatrixXd</span><span class="p">::</span><span class="n">Random</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">MatrixXd</span><span class="p">::</span><span class="n">Constant</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">1.2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">50</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">VectorXd</span> <span class="n">v</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m * v =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">*</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出为：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span>
  <span class="mi">94</span> <span class="mf">89.8</span> <span class="mf">43.5</span>
<span class="mf">49.4</span>  <span class="mi">101</span> <span class="mf">86.8</span>
<span class="mf">88.3</span> <span class="mf">29.8</span> <span class="mf">37.8</span>
<span class="n">m</span> <span class="o">*</span> <span class="n">v</span> <span class="o">=</span>
<span class="mi">404</span>
<span class="mi">512</span>
<span class="mi">261</span>
</pre></div>
</div>
<p>程序中定义了一个任意大小的矩阵，并用3<code class="docutils literal notranslate"><span class="pre">*</span></code>3的随机阵初始化。<code class="docutils literal notranslate"><span class="pre">MatrixXd::Constant</span></code>创建一个3*3的常量矩阵。</p>
<p>VectorXd表示列向量，并用<em>逗号初始化语法</em>来初始化。</p>
<p>在看同样功能的代码</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Matrix3d</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Matrix3d</span><span class="p">::</span><span class="n">Random</span><span class="p">();</span>
  <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">Matrix3d</span><span class="p">::</span><span class="n">Constant</span><span class="p">(</span><span class="mf">1.2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">50</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">Vector3d</span> <span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>

  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m * v =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">*</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>MatrixXd表示是任意尺寸的矩阵，Matrix3d直接指定了3*3的大小。Vector3d也被直接初始化为[1,2,3]'的列向量。</p>
<p>使用固定大小的矩阵或向量有两个好处：编译更快；指定大小可以进行更为严格的检查。当然使用太多类别（Matrix3d、Matrix4d、Matrix5d...）会增加编译时间和可执行文件大小，原则建议使用4及以内的。</p>
</div>
<div class="section" id="matrix">
<h2>Matrix类<a class="headerlink" href="#matrix" title="Permalink to this headline">¶</a></h2>
<p>在Eigen，所有的矩阵和向量都是<strong>Matrix</strong>模板类的对象，Vector只是一种特殊的矩阵（一行或者一列）。</p>
<p>Matrix有6个模板参数，主要使用前三个参数，剩下的有默认值。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">Scalar</span><span class="p">,</span> <span class="nb">int</span> <span class="n">RowsAtCompileTime</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ColsAtCompileTime</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Scalar是表示元素的类型，RowsAtCompileTime为矩阵的行，ColsAtCompileTime为矩阵的列。</p>
<p>库中提供了一些类型便于使用，比如：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">float</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">Matrix4f</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="vectors">
<h2>Vectors向量<a class="headerlink" href="#vectors" title="Permalink to this headline">¶</a></h2>
<p>列向量</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">float</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">Vector3f</span><span class="p">;</span>
</pre></div>
</div>
<p>行向量</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">RowVector2i</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="dynamic">
<h2>Dynamic<a class="headerlink" href="#dynamic" title="Permalink to this headline">¶</a></h2>
<p>Eigen不只限于已知大小（编译阶段）的矩阵，有些矩阵的尺寸是运行时确定的，于是引入了一个特殊的标识符：Dynamic</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">Matrix</span><span class="o">&lt;</span><span class="n">double</span><span class="p">,</span> <span class="n">Dynamic</span><span class="p">,</span> <span class="n">Dynamic</span><span class="o">&gt;</span> <span class="n">MatrixXd</span><span class="p">;</span>
<span class="n">typedef</span> <span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span> <span class="n">Dynamic</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">VectorXi</span><span class="p">;</span>
<span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">float</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Dynamic</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h2>构造函数<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>默认的构造函数不执行任何空间分配，也不初始化矩阵的元素。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix3f</span> <span class="n">a</span><span class="p">;</span>
<span class="n">MatrixXf</span> <span class="n">b</span><span class="p">;</span>
</pre></div>
</div>
<p>这里，a是一个3<em>3的矩阵，分配了float[9]的空间，但未初始化内部元素；b是一个动态大小的矩阵，定义是未分配空间(0</em>0)。</p>
<p>指定大小的矩阵，只是分配相应大小的空间，未初始化元素。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXf</span> <span class="n">a</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">);</span>
<span class="n">VectorXf</span> <span class="n">b</span><span class="p">(</span><span class="mi">30</span><span class="p">);</span>
</pre></div>
</div>
<p>这里，a是一个10*15的动态大小的矩阵，分配了空间但未初始化元素；b是一个30大小的向量，同样分配空间未初始化元素。</p>
<p>为了对固定大小和动态大小的矩阵提供统一的API，对指定大小的Matrix传递sizes也是合法的（传递也被忽略）。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix3f</span> <span class="n">a</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
</pre></div>
</div>
<p>可以用构造函数提供4以内尺寸的vector的初始化。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Vector2d</span> <span class="n">a</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">);</span>
<span class="n">Vector3d</span> <span class="n">b</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">);</span>
<span class="n">Vector4d</span> <span class="n">c</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2>获取元素<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>通过中括号获取元素，对于矩阵是：（行，列）；对于向量，只是传递它的索引，以0为起始。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">MatrixXd</span> <span class="n">m</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="n">m</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">;</span>
  <span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="n">m</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the matrix m:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">VectorXd</span> <span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
  <span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the vector v:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">matrix</span> <span class="n">m</span><span class="p">:</span>
  <span class="mi">3</span>  <span class="o">-</span><span class="mi">1</span>
<span class="mf">2.5</span> <span class="mf">1.5</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">vector</span> <span class="n">v</span><span class="p">:</span>
<span class="mi">4</span>
<span class="mi">3</span>
</pre></div>
</div>
<p>m(index)也可以用于获取矩阵元素，但取决于matrix的存储顺序，默认是按列存储的，当然也可以改为按行。</p>
<p>[]操作符可以用于向量元素的获取，但是不能用于matrix，因为C++中[]不能传递超过一个参数。</p>
</div>
<div class="section" id="id8">
<h2>逗号初始化<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix3f</span> <span class="n">m</span><span class="p">;</span>
<span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
     <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
     <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">;</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="resizing">
<h2>resizing<a class="headerlink" href="#resizing" title="Permalink to this headline">¶</a></h2>
<p>matrix的大小可以通过rows()、cols()、size()获取，resize()可以重新调整动态matrix的大小。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">MatrixXd</span> <span class="n">m</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
  <span class="n">m</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;The matrix m is of size &quot;</span>
            <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">rows</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;x&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">cols</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;It has &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; coefficients&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">VectorXd</span> <span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">v</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;The vector v is of size &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;As a matrix, v is of size &quot;</span>
            <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="o">.</span><span class="n">rows</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;x&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="o">.</span><span class="n">cols</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">matrix</span> <span class="n">m</span> <span class="ow">is</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x3</span>
<span class="n">It</span> <span class="n">has</span> <span class="mi">12</span> <span class="n">coefficients</span>
<span class="n">The</span> <span class="n">vector</span> <span class="n">v</span> <span class="ow">is</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">5</span>
<span class="n">As</span> <span class="n">a</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">v</span> <span class="ow">is</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">5</span><span class="n">x1</span>
</pre></div>
</div>
<p>如果matrix的实际大小不改变，resize函数不做任何操作。resize操作会执行析构函数：元素的值会被改变，如果不想改变执行 conservativeResize()。</p>
<p>为了统一API，所有的操作可用于指定大小的matrix，当然，实际中它不会改变大小。尝试去改变一个固定大小的matrix到一个不同的值，会出发警告失败。只有如下是合法的。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Matrix4d</span> <span class="n">m</span><span class="p">;</span>
  <span class="n">m</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span> <span class="o">//</span> <span class="n">no</span> <span class="n">operation</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;The matrix m is of size &quot;</span>
            <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">rows</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;x&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">cols</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="assignment-resizing">
<h2>assignment 和 resizing<a class="headerlink" href="#assignment-resizing" title="Permalink to this headline">¶</a></h2>
<p>assignment（分配）是复制一个矩阵到另外一个，操作符=。Eigen会自动resize左变量大小等于右变量大小，比如：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXf</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a is of size &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">rows</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;x&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">cols</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">MatrixXf</span> <span class="n">b</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a is now of size &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">rows</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;x&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">cols</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

<span class="n">a</span> <span class="ow">is</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2</span>
<span class="n">a</span> <span class="ow">is</span> <span class="n">now</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span>
</pre></div>
</div>
<p>当然，如果左边量是固定大小的，上面的resizing是不允许的。</p>
</div>
<div class="section" id="vs">
<h2>固定尺寸 vs 动态尺寸<a class="headerlink" href="#vs" title="Permalink to this headline">¶</a></h2>
<p>实际中，应该使用固定尺寸还是动态尺寸，简单的答案是：小的尺寸用固定的，大的尺寸用动态的。使用固定尺寸可以避免动态内存的开辟，固定尺寸只是一个普通数组。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Matrix4f mymatrix;` 等价于 `float mymatrix[16];
MatrixXf mymatrix(rows,columns);` 等价于 `float *mymatrix = new float[rows*columns];
</pre></div>
</div>
<p>使用固定尺寸(&lt;=4*4)需要编译前知道矩阵大小，而且对于足够大的尺寸，如大于32，固定尺寸的收益可以忽略不计，而且可能导致栈崩溃。而且基于环境，Eigen会对动态尺寸做优化（类似于std::vector）</p>
</div>
<div class="section" id="id9">
<h2>其他模板参数<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>上面只讨论了前三个参数，完整的模板参数如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">Scalar</span><span class="p">,</span>
       <span class="nb">int</span> <span class="n">RowsAtCompileTime</span><span class="p">,</span>
       <span class="nb">int</span> <span class="n">ColsAtCompileTime</span><span class="p">,</span>
       <span class="nb">int</span> <span class="n">Options</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
       <span class="nb">int</span> <span class="n">MaxRowsAtCompileTime</span> <span class="o">=</span> <span class="n">RowsAtCompileTime</span><span class="p">,</span>
       <span class="nb">int</span> <span class="n">MaxColsAtCompileTime</span> <span class="o">=</span> <span class="n">ColsAtCompileTime</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Options是一个比特标志位，这里，我们只介绍一种RowMajor，它表明matrix使用按行存储，默认是按列存储。<code class="docutils literal notranslate"><span class="pre">Matrix&lt;float,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">RowMajor&gt;</span></code></p>
<p>MaxRowsAtCompileTime和MaxColsAtCompileTime表示在编译阶段矩阵的上限。主要是避免动态内存分配，使用数组。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Matrix&lt;float, Dynamic, Dynamic, 0, 3, 4&gt;` 等价于 `float [12]
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h2>一些方便的定义<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>Eigen定义了一些类型</p>
<ul class="simple">
<li><p>MatrixNt = Matrix&lt;type, N, N&gt; 特殊地有 MatrxXi = Matrix&lt;int, Dynamic, Dynamic&gt;</p></li>
<li><p>VectorNt = Matrix&lt;type, N, 1&gt; 比如 Vector2f = Matrix&lt;float, 2, 1&gt;</p></li>
<li><p>RowVectorNt = Matrix&lt;type, 1, N&gt; 比如 RowVector3d = Matrix&lt;double, 1, 3&gt;</p></li>
</ul>
<p>N可以是2,3,4或X(Dynamic)</p>
<p>t可以是i(int)、f(float)、d(double)、cf(complex)、cd(complex)等。</p>
</div>
</div>
<div class="section" id="id11">
<h1>矩阵和向量的运算<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h1>
<p>提供一些概述和细节：关于矩阵、向量以及标量的运算。</p>
<div class="section" id="id12">
<h2>介绍<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<p>Eigen提供了matrix/vector的运算操作，既包括重载了c++的算术运算符+/-/*，也引入了一些特殊的运算比如点乘dot、叉乘cross等。</p>
<p>对于Matrix类（matrix和vectors）这些操作只支持线性代数运算，比如：matrix1*matrix2表示矩阵的乘机，vetor+scalar是不允许的。如果你想执行非线性代数操作，请看下一篇（暂时放下）。</p>
</div>
<div class="section" id="id13">
<h2>加减<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<p>左右两侧变量具有相同的尺寸（行和列），并且元素类型相同（Eigen不自动转化类型）操作包括：</p>
<ul class="simple">
<li><p>二元运算 + 如a+b</p></li>
<li><p>二元运算 - 如a-b</p></li>
<li><p>一元运算 - 如-a</p></li>
<li><p>复合运算 += 如a+=b</p></li>
<li><p>复合运算 -= 如a-=b</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Matrix2d</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
       <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">;</span>
  <span class="n">MatrixXd</span> <span class="n">b</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
       <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a + b =</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a - b =</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Doing a += b;&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">+=</span> <span class="n">b</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Now a =</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">Vector3d</span> <span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">Vector3d</span> <span class="n">w</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;-v + w - v =</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="o">-</span><span class="n">v</span> <span class="o">+</span> <span class="n">w</span> <span class="o">-</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">=</span>
<span class="mi">3</span> <span class="mi">5</span>
<span class="mi">4</span> <span class="mi">8</span>
<span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">=</span>
<span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span>
 <span class="mi">2</span>  <span class="mi">0</span>
<span class="n">Doing</span> <span class="n">a</span> <span class="o">+=</span> <span class="n">b</span><span class="p">;</span>
<span class="n">Now</span> <span class="n">a</span> <span class="o">=</span>
<span class="mi">3</span> <span class="mi">5</span>
<span class="mi">4</span> <span class="mi">8</span>
<span class="o">-</span><span class="n">v</span> <span class="o">+</span> <span class="n">w</span> <span class="o">-</span> <span class="n">v</span> <span class="o">=</span>
<span class="o">-</span><span class="mi">1</span>
<span class="o">-</span><span class="mi">4</span>
<span class="o">-</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="id14">
<h2>标量乘法和除法<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<p>乘/除标量是非常简单的，如下：</p>
<ul class="simple">
<li><p>二元运算 * 如matrix*scalar</p></li>
<li><p>二元运算 * 如scalar*matrix</p></li>
<li><p>二元运算 / 如matrix/scalar</p></li>
<li><p>复合运算 <em>= 如matrix</em>=scalar</p></li>
<li><p>复合运算 /= 如matrix/=scalar</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Matrix2d</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
       <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">;</span>
  <span class="n">Vector3d</span> <span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a * 2.5 =</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">*</span> <span class="mf">2.5</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;0.1 * v =</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Doing v *= 2;&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">v</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Now v =</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>结果</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">*</span> <span class="mf">2.5</span> <span class="o">=</span>
<span class="mf">2.5</span>   <span class="mi">5</span>
<span class="mf">7.5</span>  <span class="mi">10</span>
<span class="mf">0.1</span> <span class="o">*</span> <span class="n">v</span> <span class="o">=</span>
<span class="mf">0.1</span>
<span class="mf">0.2</span>
<span class="mf">0.3</span>
<span class="n">Doing</span> <span class="n">v</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">Now</span> <span class="n">v</span> <span class="o">=</span>
<span class="mi">2</span>
<span class="mi">4</span>
<span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="id15">
<h2>表达式模板<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<p>这里简单介绍，在高级主题中会详细解释。在Eigen中，线性运算比如+不会对变量自身做任何操作，会返回一个“表达式对象”来描述被执行的计算。当整个表达式被评估完（一般是遇到=号），实际的操作才执行。</p>
<p>这样做主要是为了优化，比如</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VectorXf</span> <span class="n">a</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">b</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">c</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">d</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
<span class="o">...</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">d</span><span class="p">;</span>
</pre></div>
</div>
<p>Eigen会编译这段代码最终遍历一次即可运算完成。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
  <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</pre></div>
</div>
<p>因此，我们不必要担心大的线性表达式的运算效率。</p>
</div>
<div class="section" id="id16">
<h2>转置和共轭<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<p><img alt="img" src="https://images2015.cnblogs.com/blog/532915/201701/532915-20170124234218331-958991885.png" /> 表示transpose转置</p>
<p><img alt="img" src="https://images2015.cnblogs.com/blog/532915/201701/532915-20170124234219644-1435768692.png" /> 表示conjugate共轭</p>
<p><img alt="img" src="https://images2015.cnblogs.com/blog/532915/201701/532915-20170124234220831-1674600657.png" /> 表示adjoint(共轭转置) 伴随矩阵</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXcf</span> <span class="n">a</span> <span class="o">=</span> <span class="n">MatrixXcf</span><span class="p">::</span><span class="n">Random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the matrix a</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the matrix a^T</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the conjugate of a</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the matrix a^*</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">matrix</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">-</span><span class="mf">0.211</span><span class="p">,</span><span class="mf">0.68</span><span class="p">)</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.605</span><span class="p">,</span><span class="mf">0.823</span><span class="p">)</span>
 <span class="p">(</span><span class="mf">0.597</span><span class="p">,</span><span class="mf">0.566</span><span class="p">)</span>  <span class="p">(</span><span class="mf">0.536</span><span class="p">,</span><span class="o">-</span><span class="mf">0.33</span><span class="p">)</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">matrix</span> <span class="n">a</span><span class="o">^</span><span class="n">T</span>
 <span class="p">(</span><span class="o">-</span><span class="mf">0.211</span><span class="p">,</span><span class="mf">0.68</span><span class="p">)</span>  <span class="p">(</span><span class="mf">0.597</span><span class="p">,</span><span class="mf">0.566</span><span class="p">)</span>
<span class="p">(</span><span class="o">-</span><span class="mf">0.605</span><span class="p">,</span><span class="mf">0.823</span><span class="p">)</span>  <span class="p">(</span><span class="mf">0.536</span><span class="p">,</span><span class="o">-</span><span class="mf">0.33</span><span class="p">)</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">conjugate</span> <span class="n">of</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">-</span><span class="mf">0.211</span><span class="p">,</span><span class="o">-</span><span class="mf">0.68</span><span class="p">)</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.605</span><span class="p">,</span><span class="o">-</span><span class="mf">0.823</span><span class="p">)</span>
 <span class="p">(</span><span class="mf">0.597</span><span class="p">,</span><span class="o">-</span><span class="mf">0.566</span><span class="p">)</span>    <span class="p">(</span><span class="mf">0.536</span><span class="p">,</span><span class="mf">0.33</span><span class="p">)</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">matrix</span> <span class="n">a</span><span class="o">^*</span>
 <span class="p">(</span><span class="o">-</span><span class="mf">0.211</span><span class="p">,</span><span class="o">-</span><span class="mf">0.68</span><span class="p">)</span>  <span class="p">(</span><span class="mf">0.597</span><span class="p">,</span><span class="o">-</span><span class="mf">0.566</span><span class="p">)</span>
<span class="p">(</span><span class="o">-</span><span class="mf">0.605</span><span class="p">,</span><span class="o">-</span><span class="mf">0.823</span><span class="p">)</span>    <span class="p">(</span><span class="mf">0.536</span><span class="p">,</span><span class="mf">0.33</span><span class="p">)</span>
</pre></div>
</div>
<p>对于实数矩阵，conjugate不执行任何操作，adjoint等价于transpose。</p>
<p>transpose和adjoint会简单的返回一个代理对象并不对本省做转置。如果执行 <code class="docutils literal notranslate"><span class="pre">b=a.transpose()</span></code> ，a不变，转置结果被赋值给b。如果执行 <code class="docutils literal notranslate"><span class="pre">a=a.transpose()</span></code> Eigen在转置结束之前结果会开始写入a，所以a的最终结果不一定等于a的转置。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Matrix2i a; a &lt;&lt; 1, 2, 3, 4;
cout &lt;&lt; &quot;Here is the matrix a:\n&quot; &lt;&lt; a &lt;&lt; endl;
a = a.transpose(); // !!! do NOT do this !!!
cout &lt;&lt; &quot;and the result of the aliasing effect:\n&quot; &lt;&lt; a &lt;&lt; endl;

Here is the matrix a:
1 2
3 4
and the result of the aliasing effect:
1 2
2 4
</pre></div>
</div>
<p>这被称为“别名问题”。在debug模式，当assertions打开的情况加，这种常见陷阱可以被自动检测到。</p>
<p>对 <code class="docutils literal notranslate"><span class="pre">a=a.transpose()</span></code> 这种操作，可以执行in-palce转置。类似还有adjointInPlace。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXf</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the initial matrix a:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">a</span><span class="o">.</span><span class="n">transposeInPlace</span><span class="p">();</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;and after being transposed:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

<span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">matrix</span> <span class="n">a</span><span class="p">:</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span>
<span class="ow">and</span> <span class="n">after</span> <span class="n">being</span> <span class="n">transposed</span><span class="p">:</span>
<span class="mi">1</span> <span class="mi">4</span>
<span class="mi">2</span> <span class="mi">5</span>
<span class="mi">3</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="id17">
<h2>矩阵-矩阵的乘法和矩阵-向量的乘法<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h2>
<p>向量也是一种矩阵，实质都是矩阵-矩阵的乘法。</p>
<ul class="simple">
<li><p>二元运算 <em>如a</em>b</p></li>
<li><p>复合运算 <em>=如a</em>=b</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Matrix2d</span> <span class="n">mat</span><span class="p">;</span>
  <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
         <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">;</span>
  <span class="n">Vector2d</span> <span class="n">u</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat*mat:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">*</span><span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat*u:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">*</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is u^T*mat:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">u</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">*</span><span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is u^T*v:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">u</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">*</span><span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is u*v^T:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Let&#39;s multiply mat by itself&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">*</span><span class="n">mat</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Now mat is mat:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Here</span> <span class="ow">is</span> <span class="n">mat</span><span class="o">*</span><span class="n">mat</span><span class="p">:</span>
 <span class="mi">7</span> <span class="mi">10</span>
<span class="mi">15</span> <span class="mi">22</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">mat</span><span class="o">*</span><span class="n">u</span><span class="p">:</span>
<span class="mi">1</span>
<span class="mi">1</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">u</span><span class="o">^</span><span class="n">T</span><span class="o">*</span><span class="n">mat</span><span class="p">:</span>
<span class="mi">2</span> <span class="mi">2</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">u</span><span class="o">^</span><span class="n">T</span><span class="o">*</span><span class="n">v</span><span class="p">:</span>
<span class="o">-</span><span class="mi">2</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">^</span><span class="n">T</span><span class="p">:</span>
<span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="mi">0</span>
 <span class="mi">2</span>  <span class="mi">0</span>
<span class="n">Let</span><span class="s1">&#39;s multiply mat by itself</span>
<span class="n">Now</span> <span class="n">mat</span> <span class="ow">is</span> <span class="n">mat</span><span class="p">:</span>
 <span class="mi">7</span> <span class="mi">10</span>
<span class="mi">15</span> <span class="mi">22</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">m=m*m</span></code>并不会导致别名问题，Eigen在这里做了特殊处理，引入了临时变量。实质将编译为：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">m</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">tmp</span>
</pre></div>
</div>
<p>如果你确定矩阵乘法是安全的（并没有别名问题），你可以使用noalias()函数来避免临时变量 <code class="docutils literal notranslate"><span class="pre">c.noalias()</span> <span class="pre">+=</span> <span class="pre">a*b</span></code> 。</p>
</div>
<div class="section" id="id18">
<h2>点运算和叉运算<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h2>
<p>dot()执行点积，cross()执行叉积，点运算得到1*1的矩阵。当然，点运算也可以用u.adjoint()*v来代替。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Vector3d</span> <span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">Vector3d</span> <span class="n">w</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Dot product: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">double</span> <span class="n">dp</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span><span class="o">*</span><span class="n">w</span><span class="p">;</span> <span class="o">//</span> <span class="n">automatic</span> <span class="n">conversion</span> <span class="n">of</span> <span class="n">the</span> <span class="n">inner</span> <span class="n">product</span> <span class="n">to</span> <span class="n">a</span> <span class="n">scalar</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Dot product via a matrix product: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">dp</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Cross product:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dot</span> <span class="n">product</span><span class="p">:</span> <span class="mi">8</span>
<span class="n">Dot</span> <span class="n">product</span> <span class="n">via</span> <span class="n">a</span> <span class="n">matrix</span> <span class="n">product</span><span class="p">:</span> <span class="mi">8</span>
<span class="n">Cross</span> <span class="n">product</span><span class="p">:</span>
 <span class="mi">1</span>
<span class="o">-</span><span class="mi">2</span>
 <span class="mi">1</span>
</pre></div>
</div>
<p>注意：点积只对三维vector有效。对于复数，Eigen的点积是第一个变量共轭和第二个变量的线性积。</p>
</div>
<div class="section" id="id19">
<h2>基础的归约操作<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
<p>Eigen提供了而一些归约函数：sum()、prod()、maxCoeff()和minCoeff()，他们对所有元素进行操作。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">Matrix2d</span> <span class="n">mat</span><span class="p">;</span>
  <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
         <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.sum():       &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>       <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.prod():      &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>      <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.mean():      &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>      <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.minCoeff():  &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">minCoeff</span><span class="p">()</span>  <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.maxCoeff():  &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">()</span>  <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.trace():     &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>     <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Here</span> <span class="ow">is</span> <span class="n">mat</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>       <span class="mi">10</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">mat</span><span class="o">.</span><span class="n">prod</span><span class="p">():</span>      <span class="mi">24</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">mat</span><span class="o">.</span><span class="n">mean</span><span class="p">():</span>      <span class="mf">2.5</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">mat</span><span class="o">.</span><span class="n">minCoeff</span><span class="p">():</span>  <span class="mi">1</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">mat</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">():</span>  <span class="mi">4</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">mat</span><span class="o">.</span><span class="n">trace</span><span class="p">():</span>     <span class="mi">5</span>
</pre></div>
</div>
<p>trace表示矩阵的迹，对角元素的和等价于 <code class="docutils literal notranslate"><span class="pre">a.diagonal().sum()</span></code> 。</p>
<p>minCoeff和maxCoeff函数也可以返回结果元素的位置信息。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix3f</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Matrix3f</span><span class="p">::</span><span class="n">Random</span><span class="p">();</span>
  <span class="n">std</span><span class="p">::</span><span class="n">ptrdiff_t</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
  <span class="nb">float</span> <span class="n">minOfM</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">minCoeff</span><span class="p">(</span><span class="o">&amp;</span><span class="n">i</span><span class="p">,</span><span class="o">&amp;</span><span class="n">j</span><span class="p">);</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the matrix m:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Its minimum coefficient (&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">minOfM</span>
       <span class="o">&lt;&lt;</span> <span class="s2">&quot;) is at position (&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;,&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">j</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;)</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="n">RowVector4i</span> <span class="n">v</span> <span class="o">=</span> <span class="n">RowVector4i</span><span class="p">::</span><span class="n">Random</span><span class="p">();</span>
  <span class="nb">int</span> <span class="n">maxOfV</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">(</span><span class="o">&amp;</span><span class="n">i</span><span class="p">);</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the vector v: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Its maximum coefficient (&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">maxOfV</span>
       <span class="o">&lt;&lt;</span> <span class="s2">&quot;) is at position &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">matrix</span> <span class="n">m</span><span class="p">:</span>
  <span class="mf">0.68</span>  <span class="mf">0.597</span>  <span class="o">-</span><span class="mf">0.33</span>
<span class="o">-</span><span class="mf">0.211</span>  <span class="mf">0.823</span>  <span class="mf">0.536</span>
 <span class="mf">0.566</span> <span class="o">-</span><span class="mf">0.605</span> <span class="o">-</span><span class="mf">0.444</span>
<span class="n">Its</span> <span class="n">minimum</span> <span class="n">coefficient</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.605</span><span class="p">)</span> <span class="ow">is</span> <span class="n">at</span> <span class="n">position</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">vector</span> <span class="n">v</span><span class="p">:</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">3</span> <span class="o">-</span><span class="mi">3</span>
<span class="n">Its</span> <span class="n">maximum</span> <span class="n">coefficient</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="ow">is</span> <span class="n">at</span> <span class="n">position</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="id20">
<h2>操作的有效性<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h2>
<p>Eigen会检测执行操作的有效性，在编译阶段Eigen会检测它们，错误信息是繁冗的，但错误信息会大写字母突出，比如:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix3f</span> <span class="n">m</span><span class="p">;</span>
<span class="n">Vector4f</span> <span class="n">v</span><span class="p">;</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">v</span><span class="p">;</span>      <span class="o">//</span> <span class="n">Compile</span><span class="o">-</span><span class="n">time</span> <span class="n">error</span><span class="p">:</span> <span class="n">YOU_MIXED_MATRICES_OF_DIFFERENT_SIZES</span>
</pre></div>
</div>
<p>当然动态尺寸的错误要在运行时发现，如果在debug模式，assertions会触发后，程序将崩溃。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXf</span> <span class="n">m</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">VectorXf</span> <span class="n">v</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">v</span><span class="p">;</span> <span class="o">//</span> <span class="n">Run</span><span class="o">-</span><span class="n">time</span> <span class="n">assertion</span> <span class="n">failure</span> <span class="n">here</span><span class="p">:</span> <span class="s2">&quot;invalid matrix product&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="array">
<h1>Array类和元素级操作<a class="headerlink" href="#array" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id21">
<h2>为什么使用Array<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h2>
<p>相对于Matrix提供的线性代数运算，Array类提供了更为一般的数组功能。Array类为元素级的操作提供了有效途径，比如点加（每个元素加值）或两个数据相应元素的点乘。</p>
</div>
<div class="section" id="id22">
<h2>Array<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h2>
<p>Array是个类模板（类似于Matrx）,前三个参数是必须指定的，后三个是可选的，这点和Matrix是相同的。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Array</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">Scalar</span><span class="p">,</span> <span class="nb">int</span> <span class="n">RowsAtCompileTime</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ColsAtCompileTime</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Eigen也提供的一些常用类定义，Array是同时支持一维和二维的（Matrix二维，Vector一维）。</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Type</th>
<th>Tyoedef</th>
</tr>
</thead>
<tbody>
<tr>
<td>Array<float,Dynamic,1></td>
<td>ArrayXf</td>
</tr>
<tr>
<td>Array<float,3,1></td>
<td>Array3f</td>
</tr>
<tr>
<td>Array<double,Dynamic,Dynamic></td>
<td>ArrayXXd</td>
</tr>
<tr>
<td>Array<double,3,3></td>
<td>Array33d</td>
</tr>
</tbody>
</table></div>
<div class="section" id="id23">
<h2>获取元素<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h2>
<p>读写操作重载于matrix， <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> 可以用于初始化array或打印。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="c1">#include &lt;iostream&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">ArrayXXf</span>  <span class="n">m</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>

  <span class="o">//</span> <span class="n">assign</span> <span class="n">some</span> <span class="n">values</span> <span class="n">coefficient</span> <span class="n">by</span> <span class="n">coefficient</span>
  <span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
  <span class="n">m</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">;</span> <span class="n">m</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>

  <span class="o">//</span> <span class="nb">print</span> <span class="n">values</span> <span class="n">to</span> <span class="n">standard</span> <span class="n">output</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">using</span> <span class="n">the</span> <span class="n">comma</span><span class="o">-</span><span class="n">initializer</span> <span class="ow">is</span> <span class="n">also</span> <span class="n">allowed</span>
  <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span>
       <span class="mf">3.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">;</span>

  <span class="o">//</span> <span class="nb">print</span> <span class="n">values</span> <span class="n">to</span> <span class="n">standard</span> <span class="n">output</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id24">
<h2>加法和减法<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h2>
<p>和matrix类似，要求array的尺寸一致。同时支持<code class="docutils literal notranslate"><span class="pre">array+/-scalar</span></code>的操作！</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="c1">#include &lt;iostream&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">ArrayXXf</span> <span class="n">a</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">ArrayXXf</span> <span class="n">b</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span>
       <span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span>
       <span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">;</span>
  <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span>
       <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span>
       <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">Adding</span> <span class="n">two</span> <span class="n">arrays</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a + b = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="o">//</span> <span class="n">Subtracting</span> <span class="n">a</span> <span class="n">scalar</span> <span class="kn">from</span> <span class="nn">an</span> <span class="n">array</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a - 2 = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">=</span>
 <span class="mi">2</span>  <span class="mi">4</span>  <span class="mi">6</span>
 <span class="mi">5</span>  <span class="mi">7</span>  <span class="mi">9</span>
 <span class="mi">8</span> <span class="mi">10</span> <span class="mi">12</span>

<span class="n">a</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">=</span>
<span class="o">-</span><span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">1</span>
 <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>
 <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>
</pre></div>
</div>
</div>
<div class="section" id="id25">
<h2>乘法<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h2>
<p>支持array<em>scalar（类似于matrix），但是当执行array</em>array时，执行的是相应元素的乘积，因此两个array必须具有相同的尺寸。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">ArrayXXf</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">ArrayXXf</span> <span class="n">b</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span>
       <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">;</span>
  <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span>
       <span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a * b = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">=</span>
 <span class="mi">5</span> <span class="mi">12</span>
<span class="mi">21</span> <span class="mi">32</span>
</pre></div>
</div>
</div>
<div class="section" id="id26">
<h2>其他元素级操作<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<thead>
<tr>
<th>Function</th>
<th>function</th>
</tr>
</thead>
<tbody>
<tr>
<td>abs</td>
<td>绝对值</td>
</tr>
<tr>
<td>sqrt</td>
<td>平方根</td>
</tr>
<tr>
<td>min(.)</td>
<td>两个array相应元素的最小值</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">ArrayXf</span> <span class="n">a</span> <span class="o">=</span> <span class="n">ArrayXf</span><span class="p">::</span><span class="n">Random</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
  <span class="n">a</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
       <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a.abs() =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
       <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a.abs().sqrt() =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
       <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;a.min(a.abs().sqrt()) =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
       <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sqrt</span><span class="p">())</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="arraymatrix">
<h2>array和matrix之间的转换<a class="headerlink" href="#arraymatrix" title="Permalink to this headline">¶</a></h2>
<p>当需要线性代数类操作时，请使用Matrix；但需要元素级操作时，需要使用Array。这样就需要提供两者的转化方法。</p>
<p>Matrix提供了.array()函数将它们转化为Array对象。</p>
<p>Array提供了.matrix()函数将它们转化为Matrix对象。</p>
<p>在Eigen，在表达式中混合Matrix和Array操作是被禁止的，但是可以将array表达式结果赋值为matrix。</p>
<p>另外，Matrix提供了cwiseProduct函数也实现了点乘。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="c1">#include &lt;iostream&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">MatrixXf</span> <span class="n">m</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">MatrixXf</span> <span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">MatrixXf</span> <span class="n">result</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span>
       <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">;</span>
  <span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span>
       <span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">;</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">n</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;-- Matrix m*n: --&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">array</span><span class="p">()</span> <span class="o">*</span> <span class="n">n</span><span class="o">.</span><span class="n">array</span><span class="p">();</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;-- Array m*n: --&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">cwiseProduct</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;-- With cwiseProduct: --&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">array</span><span class="p">()</span> <span class="o">+</span> <span class="mi">4</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;-- Array m + 4: --&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="n">Matrix</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">:</span> <span class="o">--</span>
<span class="mi">19</span> <span class="mi">22</span>
<span class="mi">43</span> <span class="mi">50</span>

<span class="o">--</span> <span class="n">Array</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">:</span> <span class="o">--</span>
 <span class="mi">5</span> <span class="mi">12</span>
<span class="mi">21</span> <span class="mi">32</span>

<span class="o">--</span> <span class="n">With</span> <span class="n">cwiseProduct</span><span class="p">:</span> <span class="o">--</span>
 <span class="mi">5</span> <span class="mi">12</span>
<span class="mi">21</span> <span class="mi">32</span>

<span class="o">--</span> <span class="n">Array</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">4</span><span class="p">:</span> <span class="o">--</span>
<span class="mi">5</span> <span class="mi">6</span>
<span class="mi">7</span> <span class="mi">8</span>
</pre></div>
</div>
<p>类似， <code class="docutils literal notranslate"><span class="pre">array1.matrix()</span> <span class="pre">*</span> <span class="pre">array2.matrix()</span></code> 将执行矩阵乘法。</p>
</div>
</div>
<div class="section" id="id27">
<h1>块操作<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h1>
<p>块是matrix或array中的矩形子部分。</p>
<div class="section" id="id28">
<h2>使用块<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h2>
<p>函数.block()，有两种形式</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>operation</th>
<th>构建一个动态尺寸的block</th>
<th>构建一个固定尺寸的block</th>
</tr>
</thead>
<tbody>
<tr>
<td>起点(i,j)块大小(p,q)</td>
<td>.block(i,j,p,q)</td>
<td>.block&lt; p,q &gt;(i,j)</td>
</tr>
</tbody>
</table><p>Eigen中，索引从0开始。</p>
<p>两个版本都可以用于固定尺寸和动态尺寸的matrix/array。功能是等价的，只是固定尺寸的版本在block较小时速度更快一些。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">MatrixXf</span> <span class="n">m</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
  <span class="n">m</span> <span class="o">&lt;&lt;</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>
        <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
        <span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span>
       <span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Block in the middle&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">block</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Block of size &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;x&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">block</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Block</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">middle</span>
 <span class="mi">6</span>  <span class="mi">7</span>
<span class="mi">10</span> <span class="mi">11</span>

<span class="n">Block</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="n">x1</span>
<span class="mi">1</span>

<span class="n">Block</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2</span>
<span class="mi">1</span> <span class="mi">2</span>
<span class="mi">5</span> <span class="mi">6</span>

<span class="n">Block</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span>
 <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>
 <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>
 <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span>
</pre></div>
</div>
<p>作为左值</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Array22f</span> <span class="n">m</span><span class="p">;</span>
  <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span>
       <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">;</span>
  <span class="n">Array44f</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Array44f</span><span class="p">::</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.6</span><span class="p">);</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the array a:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">a</span><span class="o">.</span><span class="n">block</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is now a with m copied into its central 2x2 block:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">a</span><span class="o">.</span><span class="n">block</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">block</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is now a with bottom-right 2x3 block copied into top-left 2x2 block:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">array</span> <span class="n">a</span><span class="p">:</span>
<span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span>
<span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span>
<span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span>
<span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span>

<span class="n">Here</span> <span class="ow">is</span> <span class="n">now</span> <span class="n">a</span> <span class="k">with</span> <span class="n">m</span> <span class="n">copied</span> <span class="n">into</span> <span class="n">its</span> <span class="n">central</span> <span class="mi">2</span><span class="n">x2</span> <span class="n">block</span><span class="p">:</span>
<span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span>
<span class="mf">0.6</span>   <span class="mi">1</span>   <span class="mi">2</span> <span class="mf">0.6</span>
<span class="mf">0.6</span>   <span class="mi">3</span>   <span class="mi">4</span> <span class="mf">0.6</span>
<span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span>

<span class="n">Here</span> <span class="ow">is</span> <span class="n">now</span> <span class="n">a</span> <span class="k">with</span> <span class="n">bottom</span><span class="o">-</span><span class="n">right</span> <span class="mi">2</span><span class="n">x3</span> <span class="n">block</span> <span class="n">copied</span> <span class="n">into</span> <span class="n">top</span><span class="o">-</span><span class="n">left</span> <span class="mi">2</span><span class="n">x2</span> <span class="n">block</span><span class="p">:</span>
  <span class="mi">3</span>   <span class="mi">4</span> <span class="mf">0.6</span> <span class="mf">0.6</span>
<span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span>
<span class="mf">0.6</span>   <span class="mi">3</span>   <span class="mi">4</span> <span class="mf">0.6</span>
<span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span> <span class="mf">0.6</span>
</pre></div>
</div>
</div>
<div class="section" id="id29">
<h2>行和列<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<thead>
<tr>
<th>Operation</th>
<th>Method</th>
</tr>
</thead>
<tbody>
<tr>
<td>ith row</td>
<td>matrix.row(i)</td>
</tr>
<tr>
<td>jth colum</td>
<td>matrix.col(j)</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">MatrixXf</span> <span class="n">m</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span>
       <span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span>
       <span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the matrix m:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;2nd Row: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">m</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;After adding 3 times the first column into the third column, the matrix m is:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">matrix</span> <span class="n">m</span><span class="p">:</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span>
<span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span>
<span class="mi">2</span><span class="n">nd</span> <span class="n">Row</span><span class="p">:</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span>
<span class="n">After</span> <span class="n">adding</span> <span class="mi">3</span> <span class="n">times</span> <span class="n">the</span> <span class="n">first</span> <span class="n">column</span> <span class="n">into</span> <span class="n">the</span> <span class="n">third</span> <span class="n">column</span><span class="p">,</span> <span class="n">the</span> <span class="n">matrix</span> <span class="n">m</span> <span class="ow">is</span><span class="p">:</span>
 <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">6</span>
 <span class="mi">4</span>  <span class="mi">5</span> <span class="mi">18</span>
 <span class="mi">7</span>  <span class="mi">8</span> <span class="mi">30</span>
</pre></div>
</div>
</div>
<div class="section" id="id30">
<h2>角相关操作<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<thead>
<tr>
<th>operation</th>
<th>dynamic-size block</th>
<th>fixed-size block</th>
</tr>
</thead>
<tbody>
<tr>
<td>左上角p*q</td>
<td>matrix.topLeftCorner(p,q);</td>
<td>matrix.topLeftCorner&lt; p,q &gt;();</td>
</tr>
<tr>
<td>左下角p*q</td>
<td>matrix.bottomLeftCorner(p,q);</td>
<td>matrix.bottomLeftCorner&lt; p,q &gt;();</td>
</tr>
<tr>
<td>右上角p*q</td>
<td>matrix.topRightCorner(p,q);</td>
<td>matrix.topRightCorner&lt; p,q &gt;();</td>
</tr>
<tr>
<td>右下角p*q</td>
<td>matrix.bottomRightCorner(p,q);</td>
<td>matrix.bottomRightCorner&lt; p,q &gt;();</td>
</tr>
<tr>
<td>前q行</td>
<td>matrix.topRows(q);</td>
<td>matrix.topRows&lt; q &gt;();</td>
</tr>
<tr>
<td>后q行</td>
<td>matrix.bottomRows(q);</td>
<td>matrix.bottomRows&lt; q &gt;();</td>
</tr>
<tr>
<td>左p列</td>
<td>matrix.leftCols(p);</td>
<td>matrix.leftCols&lt; p &gt;();</td>
</tr>
<tr>
<td>右p列</td>
<td>matrix.rightCols(p);</td>
<td>matrix.rightCols&lt; p &gt;();</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">Matrix4f</span> <span class="n">m</span><span class="p">;</span>
  <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>
       <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
       <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span>
       <span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m.leftCols(2) =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">leftCols</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m.bottomRows&lt;2&gt;() =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">bottomRows</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">m</span><span class="o">.</span><span class="n">topLeftCorner</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">bottomRightCorner</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">();</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;After assignment, m = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">leftCols</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>
 <span class="mi">1</span>  <span class="mi">2</span>
 <span class="mi">5</span>  <span class="mi">6</span>
 <span class="mi">9</span> <span class="mi">10</span>
<span class="mi">13</span> <span class="mi">14</span>

<span class="n">m</span><span class="o">.</span><span class="n">bottomRows</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">=</span>
 <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span>
<span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="mi">16</span>

<span class="n">After</span> <span class="n">assignment</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span>
 <span class="mi">8</span> <span class="mi">12</span> <span class="mi">16</span>  <span class="mi">4</span>
 <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span>
 <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span>
<span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="mi">16</span>
</pre></div>
</div>
</div>
<div class="section" id="id31">
<h2>vectors的块操作<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<thead>
<tr>
<th>operation</th>
<th>dynamic-size block</th>
<th>fixed-size block</th>
</tr>
</thead>
<tbody>
<tr>
<td>前n个</td>
<td>vector.head(n);</td>
<td>vector.head&lt; n &gt;();</td>
</tr>
<tr>
<td>后n个</td>
<td>vector.tail(n);</td>
<td>vector.tail&lt; n &gt;();</td>
</tr>
<tr>
<td>i起始的n个元素</td>
<td>vector.segment(i,n);</td>
<td>vector.segment&lt; n &gt;(i);</td>
</tr>
</tbody>
</table></div>
</div>
<div class="section" id="id32">
<h1>高级初始化方法<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h1>
<p>本篇介绍几种高级的矩阵初始化方法，重点介绍逗号初始化和特殊矩阵（单位阵、零阵）。</p>
<div class="section" id="id33">
<h2>逗号初始化<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h2>
<p>Eigen提供了逗号操作符允许我们方便地为矩阵/向量/数组中的元素赋值。顺序是从左上到右下：自左到右，从上至下。对象的尺寸需要事先指定，初始化的参数也应该和要操作的元素数目一致。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix3f</span> <span class="n">m</span><span class="p">;</span>
<span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
     <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
     <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">;</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="p">;</span>
</pre></div>
</div>
<p>初始化列表不仅可以是数值也可以是vectors或matrix。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RowVectorXd</span> <span class="n">vec1</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="n">vec1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;vec1 = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">vec1</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">RowVectorXd</span> <span class="n">vec2</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="n">vec2</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">;</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;vec2 = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">vec2</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">RowVectorXd</span> <span class="n">joined</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
<span class="n">joined</span> <span class="o">&lt;&lt;</span> <span class="n">vec1</span><span class="p">,</span> <span class="n">vec2</span><span class="p">;</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;joined = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">joined</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vec1</span> <span class="o">=</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="n">vec2</span> <span class="o">=</span>  <span class="mi">1</span>  <span class="mi">4</span>  <span class="mi">9</span> <span class="mi">16</span>
<span class="n">joined</span> <span class="o">=</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">1</span>  <span class="mi">4</span>  <span class="mi">9</span> <span class="mi">16</span>
</pre></div>
</div>
<p>也可以使用块结构。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXf</span> <span class="n">matA</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">matA</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">;</span>
<span class="n">MatrixXf</span> <span class="n">matB</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="n">matB</span> <span class="o">&lt;&lt;</span> <span class="n">matA</span><span class="p">,</span> <span class="n">matA</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">matA</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">matA</span><span class="p">;</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">matB</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="mi">1</span>   <span class="mi">2</span> <span class="mf">0.1</span> <span class="mf">0.2</span>
  <span class="mi">3</span>   <span class="mi">4</span> <span class="mf">0.3</span> <span class="mf">0.4</span>
<span class="mf">0.1</span> <span class="mf">0.2</span>   <span class="mi">1</span>   <span class="mi">2</span>
<span class="mf">0.3</span> <span class="mf">0.4</span>   <span class="mi">3</span>   <span class="mi">4</span>
</pre></div>
</div>
<p>同时逗号初始化方式也可以用来为块表达式赋值。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix3f</span> <span class="n">m</span><span class="p">;</span>
<span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">m</span><span class="o">.</span><span class="n">block</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">;</span>
<span class="n">m</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">;</span>  
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="p">;</span>

<span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span>
<span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span>
</pre></div>
</div>
</div>
<div class="section" id="id34">
<h2>特殊的矩阵和向量<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h2>
<p>零阵：类的静态成员函数Zero()，有三种定义形式。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;A fixed-size array:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="n">Array33f</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">Array33f</span><span class="p">::</span><span class="n">Zero</span><span class="p">();</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a1</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;A one-dimensional dynamic-size array:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="n">ArrayXf</span> <span class="n">a2</span> <span class="o">=</span> <span class="n">ArrayXf</span><span class="p">::</span><span class="n">Zero</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a2</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;A two-dimensional dynamic-size array:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="n">ArrayXXf</span> <span class="n">a3</span> <span class="o">=</span> <span class="n">ArrayXXf</span><span class="p">::</span><span class="n">Zero</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a3</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="n">fixed</span><span class="o">-</span><span class="n">size</span> <span class="n">array</span><span class="p">:</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>

<span class="n">A</span> <span class="n">one</span><span class="o">-</span><span class="n">dimensional</span> <span class="n">dynamic</span><span class="o">-</span><span class="n">size</span> <span class="n">array</span><span class="p">:</span>
<span class="mi">0</span>
<span class="mi">0</span>
<span class="mi">0</span>

<span class="n">A</span> <span class="n">two</span><span class="o">-</span><span class="n">dimensional</span> <span class="n">dynamic</span><span class="o">-</span><span class="n">size</span> <span class="n">array</span><span class="p">:</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
<p>类似地，还有常量矩阵：Constant([rows],[cols],value)，Random()随机矩阵。</p>
<p>单位阵Identity()方法只能使用与Matrix不使用Array，因为单位阵是个线性代数概念。</p>
<p>LinSpaced(size, low, high)可以从low到high等间距的size长度的序列，适用于vector和一维数组。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ArrayXXf</span> <span class="n">table</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="n">table</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">ArrayXf</span><span class="p">::</span><span class="n">LinSpaced</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">);</span>
<span class="n">table</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">M_PI</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">table</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">table</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sin</span><span class="p">();</span>
<span class="n">table</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cos</span><span class="p">();</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;  Degrees   Radians      Sine    Cosine</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">table</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">Degrees</span>   <span class="n">Radians</span>      <span class="n">Sine</span>    <span class="n">Cosine</span>
        <span class="mi">0</span>         <span class="mi">0</span>         <span class="mi">0</span>         <span class="mi">1</span>
       <span class="mi">10</span>     <span class="mf">0.175</span>     <span class="mf">0.174</span>     <span class="mf">0.985</span>
       <span class="mi">20</span>     <span class="mf">0.349</span>     <span class="mf">0.342</span>      <span class="mf">0.94</span>
       <span class="mi">30</span>     <span class="mf">0.524</span>       <span class="mf">0.5</span>     <span class="mf">0.866</span>
       <span class="mi">40</span>     <span class="mf">0.698</span>     <span class="mf">0.643</span>     <span class="mf">0.766</span>
       <span class="mi">50</span>     <span class="mf">0.873</span>     <span class="mf">0.766</span>     <span class="mf">0.643</span>
       <span class="mi">60</span>      <span class="mf">1.05</span>     <span class="mf">0.866</span>       <span class="mf">0.5</span>
       <span class="mi">70</span>      <span class="mf">1.22</span>      <span class="mf">0.94</span>     <span class="mf">0.342</span>
       <span class="mi">80</span>       <span class="mf">1.4</span>     <span class="mf">0.985</span>     <span class="mf">0.174</span>
       <span class="mi">90</span>      <span class="mf">1.57</span>         <span class="mi">1</span> <span class="o">-</span><span class="mf">4.37e-08</span>
</pre></div>
</div>
<div class="section" id="id35">
<h3>功能函数<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h3>
<p>Eigen也提供可同样功能的函数：setZero(), MatrixBase::setIdentity()和 DenseBase::setLinSpaced()。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="nb">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
<span class="n">MatrixXd</span> <span class="n">mat1</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
<span class="n">mat1</span><span class="o">.</span><span class="n">topLeftCorner</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>     <span class="o">=</span> <span class="n">MatrixXd</span><span class="p">::</span><span class="n">Zero</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">mat1</span><span class="o">.</span><span class="n">topRightCorner</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>    <span class="o">=</span> <span class="n">MatrixXd</span><span class="p">::</span><span class="n">Identity</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">mat1</span><span class="o">.</span><span class="n">bottomLeftCorner</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="n">MatrixXd</span><span class="p">::</span><span class="n">Identity</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">mat1</span><span class="o">.</span><span class="n">bottomRightCorner</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">MatrixXd</span><span class="p">::</span><span class="n">Zero</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mat1</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">MatrixXd</span> <span class="n">mat2</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
<span class="n">mat2</span><span class="o">.</span><span class="n">topLeftCorner</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">setZero</span><span class="p">();</span>
<span class="n">mat2</span><span class="o">.</span><span class="n">topRightCorner</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">setIdentity</span><span class="p">();</span>
<span class="n">mat2</span><span class="o">.</span><span class="n">bottomLeftCorner</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">setIdentity</span><span class="p">();</span>
<span class="n">mat2</span><span class="o">.</span><span class="n">bottomRightCorner</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">setZero</span><span class="p">();</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mat2</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">MatrixXd</span> <span class="n">mat3</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
<span class="n">mat3</span> <span class="o">&lt;&lt;</span> <span class="n">MatrixXd</span><span class="p">::</span><span class="n">Zero</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">MatrixXd</span><span class="p">::</span><span class="n">Identity</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">MatrixXd</span><span class="p">::</span><span class="n">Identity</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">MatrixXd</span><span class="p">::</span><span class="n">Zero</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mat3</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出均为</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
<p>三种赋值（初始化）的方式逗号初始化、特殊阵的静态方法和功能函数setXxx()。</p>
</div>
</div>
<div class="section" id="id36">
<h2>表达式变量<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h2>
<p>上面的静态方法如 Zero()、Constant()并不是直接返回一个矩阵或数组，实际上它们返回的是是‘expression object’，只是临时被使用/被用于优化。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">MatrixXd</span><span class="p">::</span><span class="n">Constant</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">1.2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">50</span><span class="p">;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">MatrixXf::Constant(3,3,1.2)</span></code>构建的是一个3*3的矩阵表达式（临时变量）。</p>
<p>逗号初始化的方式也可以构建这种临时变量，这是为了获取真正的矩阵需要调用finished()函数：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXf</span> <span class="n">mat</span> <span class="o">=</span> <span class="n">MatrixXf</span><span class="p">::</span><span class="n">Random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">mat</span> <span class="o">=</span> <span class="p">(</span><span class="n">MatrixXf</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">finished</span><span class="p">()</span> <span class="o">*</span> <span class="n">mat</span><span class="p">;</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="mf">0.68</span>  <span class="mf">0.566</span>  <span class="mf">0.823</span>
<span class="o">-</span><span class="mf">0.211</span>  <span class="mf">0.597</span> <span class="o">-</span><span class="mf">0.605</span>

<span class="o">-</span><span class="mf">0.211</span>  <span class="mf">0.597</span> <span class="o">-</span><span class="mf">0.605</span>
  <span class="mf">0.68</span>  <span class="mf">0.566</span>  <span class="mf">0.823</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id37">
<h1>归约、迭代器和广播<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id38">
<h2>归约<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h2>
<p>在Eigen中，有些函数可以统计matrix/array的某类特征，返回一个标量。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">Matrix2d</span> <span class="n">mat</span><span class="p">;</span>
  <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
         <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.sum():       &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>       <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.prod():      &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>      <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.mean():      &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>      <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.minCoeff():  &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">minCoeff</span><span class="p">()</span>  <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.maxCoeff():  &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">()</span>  <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is mat.trace():     &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>     <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="id39">
<h3>范数计算<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h3>
<p>L2范数 squareNorm()，等价于计算vector的自身点积，norm()返回squareNorm的开方根。</p>
<p>这些操作应用于matrix，norm() 会返回Frobenius或Hilbert-Schmidt范数。</p>
<p>如果你想使用其他Lp范数，可以使用lpNorm&lt; p &gt;()方法。p可以取Infinity，表示L∞范数。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">VectorXf</span> <span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">MatrixXf</span> <span class="n">m</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>

  <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
       <span class="mi">2</span><span class="p">;</span>

  <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span>
       <span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;v.squaredNorm() = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="o">.</span><span class="n">squaredNorm</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;v.norm() = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;v.lpNorm&lt;1&gt;() = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="o">.</span><span class="n">lpNorm</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;v.lpNorm&lt;Infinity&gt;() = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="o">.</span><span class="n">lpNorm</span><span class="o">&lt;</span><span class="n">Infinity</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m.squaredNorm() = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">squaredNorm</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m.norm() = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m.lpNorm&lt;1&gt;() = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">lpNorm</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m.lpNorm&lt;Infinity&gt;() = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">lpNorm</span><span class="o">&lt;</span><span class="n">Infinity</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">squaredNorm</span><span class="p">()</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">v</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">=</span> <span class="mf">2.23607</span>
<span class="n">v</span><span class="o">.</span><span class="n">lpNorm</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">v</span><span class="o">.</span><span class="n">lpNorm</span><span class="o">&lt;</span><span class="n">Infinity</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">m</span><span class="o">.</span><span class="n">squaredNorm</span><span class="p">()</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">m</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">=</span> <span class="mf">5.47723</span>
<span class="n">m</span><span class="o">.</span><span class="n">lpNorm</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">m</span><span class="o">.</span><span class="n">lpNorm</span><span class="o">&lt;</span><span class="n">Infinity</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p><strong>Operator norm</strong>: 1-norm和∞-norm可以通过其他方式得到。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">MatrixXf</span> <span class="n">m</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span>
       <span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;1-norm(m)     = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">cwiseAbs</span><span class="p">()</span><span class="o">.</span><span class="n">colwise</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">()</span>
       <span class="o">&lt;&lt;</span> <span class="s2">&quot; == &quot;</span>             <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">colwise</span><span class="p">()</span><span class="o">.</span><span class="n">lpNorm</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">()</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;infty-norm(m) = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">cwiseAbs</span><span class="p">()</span><span class="o">.</span><span class="n">rowwise</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">()</span>
       <span class="o">&lt;&lt;</span> <span class="s2">&quot; == &quot;</span>             <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">rowwise</span><span class="p">()</span><span class="o">.</span><span class="n">lpNorm</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">()</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="mi">1</span><span class="o">-</span><span class="n">norm</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>     <span class="o">=</span> <span class="mi">6</span> <span class="o">==</span> <span class="mi">6</span>
<span class="n">infty</span><span class="o">-</span><span class="n">norm</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">==</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
<div class="section" id="id40">
<h3>布尔归约<a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h3>
<p>all()=true matrix/array中的所有算术是true any()=true matrix/array中至少有一个元素是true count() 返回为true元素的数目</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;Eigen/Dense&gt;</span>
<span class="c1">#include &lt;iostream&gt;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">ArrayXXf</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>

  <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span>
       <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;(a &gt; 0).all()   = &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;(a &gt; 0).any()   = &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;(a &gt; 0).count() = &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;(a &gt; 2).all()   = &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;(a &gt; 2).any()   = &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;(a &gt; 2).count() = &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>   <span class="o">=</span> <span class="mi">1</span>
<span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>   <span class="o">=</span> <span class="mi">1</span>
<span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">=</span> <span class="mi">4</span>

<span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>   <span class="o">=</span> <span class="mi">0</span>
<span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>   <span class="o">=</span> <span class="mi">1</span>
<span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id41">
<h2>迭代器(遍历)<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h2>
<p>当我们想获取某元素在Matrix或Array中的位置的时候，迭代器是必须的。常用的有：minCoeff和maxCoeff。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">MatrixXf</span> <span class="n">m</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>

  <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
       <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">;</span>
  <span class="o">//</span><span class="n">get</span> <span class="n">location</span> <span class="n">of</span> <span class="n">maximum</span>
  <span class="n">MatrixXf</span><span class="p">::</span><span class="n">Index</span> <span class="n">maxRow</span><span class="p">,</span> <span class="n">maxCol</span><span class="p">;</span>
  <span class="nb">float</span> <span class="nb">max</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">(</span><span class="o">&amp;</span><span class="n">maxRow</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">maxCol</span><span class="p">);</span>
  <span class="o">//</span><span class="n">get</span> <span class="n">location</span> <span class="n">of</span> <span class="n">minimum</span>
  <span class="n">MatrixXf</span><span class="p">::</span><span class="n">Index</span> <span class="n">minRow</span><span class="p">,</span> <span class="n">minCol</span><span class="p">;</span>
  <span class="nb">float</span> <span class="nb">min</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">minCoeff</span><span class="p">(</span><span class="o">&amp;</span><span class="n">minRow</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">minCol</span><span class="p">);</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Max: &quot;</span> <span class="o">&lt;&lt;</span> <span class="nb">max</span> <span class="o">&lt;&lt;</span>  <span class="s2">&quot;, at: &quot;</span> <span class="o">&lt;&lt;</span>
     <span class="n">maxRow</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;,&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">maxCol</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Min: &quot;</span> <span class="o">&lt;&lt;</span> <span class="nb">min</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;, at: &quot;</span> <span class="o">&lt;&lt;</span>
     <span class="n">minRow</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;,&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">minCol</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Max</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="n">at</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
<span class="n">Min</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">at</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="id42">
<h2>部分归约<a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h2>
<p>Eigen中支持对Matrx或Array的行/行进行归约操作。部分归约可以使用colwise()/rowwise()函数。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">MatrixXf</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
  <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
         <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">;</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Column&#39;s maximum: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span>
   <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">colwise</span><span class="p">()</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Column</span><span class="s1">&#39;s maximum:</span>
<span class="mi">3</span> <span class="mi">2</span> <span class="mi">7</span> <span class="mi">9</span>
</pre></div>
</div>
<p>类似，针对行也可以，只是返回的是列向量而已。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">MatrixXf</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
  <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
         <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">;</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Row&#39;s maximum: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span>
   <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">rowwise</span><span class="p">()</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Row</span><span class="s1">&#39;s maximum:</span>
<span class="mi">9</span>
<span class="mi">7</span>
</pre></div>
</div>
</div>
<div class="section" id="id43">
<h2>结合部分归约和其他操作<a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h2>
<p>例子：寻找和最大的列向量。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">MatrixXf</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
  <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
         <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">;</span>

  <span class="n">MatrixXf</span><span class="p">::</span><span class="n">Index</span>   <span class="n">maxIndex</span><span class="p">;</span>
  <span class="nb">float</span> <span class="n">maxNorm</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">colwise</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">maxCoeff</span><span class="p">(</span><span class="o">&amp;</span><span class="n">maxIndex</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Maximum sum at position &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">maxIndex</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;The corresponding vector is: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span><span class="o">.</span><span class="n">col</span><span class="p">(</span> <span class="n">maxIndex</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;And its sum is is: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">maxNorm</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Maximum</span> <span class="nb">sum</span> <span class="n">at</span> <span class="n">position</span> <span class="mi">2</span>
<span class="n">The</span> <span class="n">corresponding</span> <span class="n">vector</span> <span class="ow">is</span><span class="p">:</span>
<span class="mi">6</span>
<span class="mi">7</span>
<span class="n">And</span> <span class="n">its</span> <span class="nb">sum</span> <span class="ow">is</span> <span class="ow">is</span><span class="p">:</span> <span class="mi">13</span>
</pre></div>
</div>
</div>
<div class="section" id="id44">
<h2>广播<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h2>
<p>广播是针对vector的，将vector沿行/列重复构建一个matrix，便于后期运算。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">MatrixXf</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">VectorXf</span> <span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

  <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
         <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">;</span>

  <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">,</span>
       <span class="mi">1</span><span class="p">;</span>

  <span class="o">//</span><span class="n">add</span> <span class="n">v</span> <span class="n">to</span> <span class="n">each</span> <span class="n">column</span> <span class="n">of</span> <span class="n">m</span>
  <span class="n">mat</span><span class="o">.</span><span class="n">colwise</span><span class="p">()</span> <span class="o">+=</span> <span class="n">v</span><span class="p">;</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Broadcasting result: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Broadcasting</span> <span class="n">result</span><span class="p">:</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">6</span> <span class="mi">9</span>
<span class="mi">4</span> <span class="mi">2</span> <span class="mi">8</span> <span class="mi">3</span>
</pre></div>
</div>
<p>注意：对Array类型，*=，/=和/这些操作可以进行行/列级的操作，但不使用与Matrix，因为会与矩阵乘混淆。</p>
</div>
<div class="section" id="id45">
<h2>结合广播和其他操作<a class="headerlink" href="#id45" title="Permalink to this headline">¶</a></h2>
<p>示例：计算矩阵中哪列与目标向量距离最近。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">MatrixXf</span> <span class="n">m</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
  <span class="n">Eigen</span><span class="p">::</span><span class="n">VectorXf</span> <span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

  <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
       <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">;</span>

  <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">,</span>
       <span class="mi">3</span><span class="p">;</span>
  <span class="n">MatrixXf</span><span class="p">::</span><span class="n">Index</span> <span class="n">index</span><span class="p">;</span>
  <span class="o">//</span> <span class="n">find</span> <span class="n">nearest</span> <span class="n">neighbour</span>
  <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">colwise</span><span class="p">()</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">colwise</span><span class="p">()</span><span class="o">.</span><span class="n">squaredNorm</span><span class="p">()</span><span class="o">.</span><span class="n">minCoeff</span><span class="p">(</span><span class="o">&amp;</span><span class="n">index</span><span class="p">);</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Nearest neighbour is column &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">index</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Nearest</span> <span class="n">neighbour</span> <span class="ow">is</span> <span class="n">column</span> <span class="mi">0</span><span class="p">:</span>
<span class="mi">1</span>
<span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="map">
<h1>原生缓存的接口：Map类<a class="headerlink" href="#map" title="Permalink to this headline">¶</a></h1>
<p>这篇将解释Eigen如何与原生raw C/C++ 数组混合编程。</p>
<div class="section" id="id46">
<h2>简介<a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h2>
<p>Eigen中定义了一系列的vector和matrix，相比copy数据，更一般的方式是复用数据的内存，将它们转变为Eigen类型。Map类很好地实现了这个功能。</p>
</div>
<div class="section" id="id47">
<h2>Map类型<a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h2>
<p>Map的定义</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">Scalar</span><span class="p">,</span> <span class="nb">int</span> <span class="n">RowsAtCompileTime</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ColsAtCompileTime</span><span class="o">&gt;</span> <span class="o">&gt;</span>
</pre></div>
</div>
<p>默认情况下，Mao只需要一个模板参数。</p>
<p>为了构建Map变量，我们需要其余的两个信息：一个指向元素数组的指针，Matrix/vector的尺寸。定义一个float类型的矩阵： <code class="docutils literal notranslate"><span class="pre">Map&lt;MatrixXf&gt;</span> <span class="pre">mf(pf,rows,columns);</span></code> pf是一个数组指针float *。</p>
<p>固定尺寸的整形vector声明： <code class="docutils literal notranslate"><span class="pre">Map&lt;const</span> <span class="pre">Vector4i&gt;</span> <span class="pre">mi(pi);</span></code></p>
<p>注意:Map没有默认的构造函数，你需要传递一个指针来初始化对象。</p>
<p>Mat是灵活地足够去容纳多种不同的数据表示，其他的两个模板参数：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">MatrixType</span><span class="p">,</span>
    <span class="nb">int</span> <span class="n">MapOptions</span><span class="p">,</span>
    <span class="n">typename</span> <span class="n">StrideType</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>MapOptions标识指针是否是对齐的（Aligned），默认是Unaligned。</p>
<p>StrideType表示内存数组的组织方式：行列的步长。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="k">for</span><span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Column-major:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Row-major:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">RowMajor</span><span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Row-major using stride:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span>
  <span class="n">Map</span><span class="o">&lt;</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">Unaligned</span><span class="p">,</span> <span class="n">Stride</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Column</span><span class="o">-</span><span class="n">major</span><span class="p">:</span>
<span class="mi">0</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span>
<span class="mi">1</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">7</span>
<span class="n">Row</span><span class="o">-</span><span class="n">major</span><span class="p">:</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span>
<span class="n">Row</span><span class="o">-</span><span class="n">major</span> <span class="n">using</span> <span class="n">stride</span><span class="p">:</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
<div class="section" id="id48">
<h2>使用Map变量<a class="headerlink" href="#id48" title="Permalink to this headline">¶</a></h2>
<p>可以像Eigen的其他类型一样来使用Map类型。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">float</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">Dynamic</span><span class="o">&gt;</span> <span class="n">MatrixType</span><span class="p">;</span>
<span class="n">typedef</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">MatrixType</span><span class="o">&gt;</span> <span class="n">MapType</span><span class="p">;</span>
<span class="n">typedef</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">const</span> <span class="n">MatrixType</span><span class="o">&gt;</span> <span class="n">MapTypeConst</span><span class="p">;</span>   <span class="o">//</span> <span class="n">a</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span> <span class="nb">map</span>
<span class="n">const</span> <span class="nb">int</span> <span class="n">n_dims</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="n">MatrixType</span> <span class="n">m1</span><span class="p">(</span><span class="n">n_dims</span><span class="p">),</span> <span class="n">m2</span><span class="p">(</span><span class="n">n_dims</span><span class="p">);</span>
<span class="n">m1</span><span class="o">.</span><span class="n">setRandom</span><span class="p">();</span>
<span class="n">m2</span><span class="o">.</span><span class="n">setRandom</span><span class="p">();</span>
<span class="nb">float</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">m2</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>  <span class="o">//</span> <span class="n">get</span> <span class="n">the</span> <span class="n">address</span> <span class="n">storing</span> <span class="n">the</span> <span class="n">data</span> <span class="k">for</span> <span class="n">m2</span>
<span class="n">MapType</span> <span class="n">m2map</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">m2</span><span class="o">.</span><span class="n">size</span><span class="p">());</span>   <span class="o">//</span> <span class="n">m2map</span> <span class="n">shares</span> <span class="n">data</span> <span class="k">with</span> <span class="n">m2</span>
<span class="n">MapTypeConst</span> <span class="n">m2mapconst</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">m2</span><span class="o">.</span><span class="n">size</span><span class="p">());</span>  <span class="o">//</span> <span class="n">a</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span> <span class="n">accessor</span> <span class="k">for</span> <span class="n">m2</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m1: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m1</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m2: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m2</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Squared euclidean distance: &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">m1</span><span class="o">-</span><span class="n">m2</span><span class="p">)</span><span class="o">.</span><span class="n">squaredNorm</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Squared euclidean distance, using map: &quot;</span> <span class="o">&lt;&lt;</span>
  <span class="p">(</span><span class="n">m1</span><span class="o">-</span><span class="n">m2map</span><span class="p">)</span><span class="o">.</span><span class="n">squaredNorm</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">m2map</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>   <span class="o">//</span> <span class="n">this</span> <span class="n">will</span> <span class="n">change</span> <span class="n">m2</span><span class="p">,</span> <span class="n">since</span> <span class="n">they</span> <span class="n">share</span> <span class="n">the</span> <span class="n">same</span> <span class="n">array</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Updated m2: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m2</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;m2 coefficient 2, constant accessor: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m2mapconst</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="o">/*</span> <span class="n">m2mapconst</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="o">*/</span>   <span class="o">//</span> <span class="n">this</span> <span class="n">yields</span> <span class="n">a</span> <span class="nb">compile</span><span class="o">-</span><span class="n">time</span> <span class="n">error</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span><span class="p">:</span>   <span class="mf">0.68</span> <span class="o">-</span><span class="mf">0.211</span>  <span class="mf">0.566</span>  <span class="mf">0.597</span>  <span class="mf">0.823</span>
<span class="n">m2</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.605</span>  <span class="o">-</span><span class="mf">0.33</span>  <span class="mf">0.536</span> <span class="o">-</span><span class="mf">0.444</span>  <span class="mf">0.108</span>
<span class="n">Squared</span> <span class="n">euclidean</span> <span class="n">distance</span><span class="p">:</span> <span class="mf">3.26</span>
<span class="n">Squared</span> <span class="n">euclidean</span> <span class="n">distance</span><span class="p">,</span> <span class="n">using</span> <span class="nb">map</span><span class="p">:</span> <span class="mf">3.26</span>
<span class="n">Updated</span> <span class="n">m2</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.605</span>  <span class="o">-</span><span class="mf">0.33</span>  <span class="mf">0.536</span>      <span class="mi">7</span>  <span class="mf">0.108</span>
<span class="n">m2</span> <span class="n">coefficient</span> <span class="mi">2</span><span class="p">,</span> <span class="n">constant</span> <span class="n">accessor</span><span class="p">:</span> <span class="mf">0.536</span>
</pre></div>
</div>
<p>Eigen提供的函数都兼容Map对象。</p>
</div>
<div class="section" id="mapped">
<h2>改变mapped数组<a class="headerlink" href="#mapped" title="Permalink to this headline">¶</a></h2>
<p>Map对象声明后，可以通过C++的placement new语法来改变Map的数组。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">};</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">RowVectorXi</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;The mapped vector v is: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="n">new</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">v</span><span class="p">)</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">RowVectorXi</span><span class="o">&gt;</span><span class="p">(</span><span class="n">data</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Now v is: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>

<span class="n">The</span> <span class="n">mapped</span> <span class="n">vector</span> <span class="n">v</span> <span class="ow">is</span><span class="p">:</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span>
<span class="n">Now</span> <span class="n">v</span> <span class="ow">is</span><span class="p">:</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span>
</pre></div>
</div>
<p>Eigen并没有为matrix提供直接的Reshape和Slicing的API，但是这些特性可以通过Map类来实现。</p>
</div>
<div class="section" id="reshape">
<h2>Reshape<a class="headerlink" href="#reshape" title="Permalink to this headline">¶</a></h2>
<p>reshape操作是改变matrix的尺寸大小但保持元素不变。采用的方法是创建一个不同“视图” Map。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXf</span> <span class="n">M1</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>    <span class="o">//</span> <span class="n">Column</span><span class="o">-</span><span class="n">major</span> <span class="n">storage</span>
<span class="n">M1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
      <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
      <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">RowVectorXf</span><span class="o">&gt;</span> <span class="n">v1</span><span class="p">(</span><span class="n">M1</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">M1</span><span class="o">.</span><span class="n">size</span><span class="p">());</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;v1:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">v1</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">float</span><span class="p">,</span><span class="n">Dynamic</span><span class="p">,</span><span class="n">Dynamic</span><span class="p">,</span><span class="n">RowMajor</span><span class="o">&gt;</span> <span class="n">M2</span><span class="p">(</span><span class="n">M1</span><span class="p">);</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">RowVectorXf</span><span class="o">&gt;</span> <span class="n">v2</span><span class="p">(</span><span class="n">M2</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">M2</span><span class="o">.</span><span class="n">size</span><span class="p">());</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;v2:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">v2</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span><span class="p">:</span>
<span class="mi">1</span> <span class="mi">4</span> <span class="mi">7</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">8</span> <span class="mi">3</span> <span class="mi">6</span> <span class="mi">9</span>
<span class="n">v2</span><span class="p">:</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span>
</pre></div>
</div>
<p>reshape 2<em>6的矩阵到 6</em>2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXf</span> <span class="n">M1</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>    <span class="o">//</span> <span class="n">Column</span><span class="o">-</span><span class="n">major</span> <span class="n">storage</span>
<span class="n">M1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>
      <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">MatrixXf</span><span class="o">&gt;</span> <span class="n">M2</span><span class="p">(</span><span class="n">M1</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;M2:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">M2</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M2</span><span class="p">:</span>
 <span class="mi">1</span>  <span class="mi">4</span>
 <span class="mi">7</span> <span class="mi">10</span>
 <span class="mi">2</span>  <span class="mi">5</span>
 <span class="mi">8</span> <span class="mi">11</span>
 <span class="mi">3</span>  <span class="mi">6</span>
 <span class="mi">9</span> <span class="mi">12</span>
</pre></div>
</div>
</div>
<div class="section" id="slicing">
<h2>Slicing<a class="headerlink" href="#slicing" title="Permalink to this headline">¶</a></h2>
<p>也是通过Map实现的，比如：每p个元素获取一个。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RowVectorXf</span> <span class="n">v</span> <span class="o">=</span> <span class="n">RowVectorXf</span><span class="p">::</span><span class="n">LinSpaced</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">19</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Input:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">RowVectorXf</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">InnerStride</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">v2</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">v</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Even:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v2</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Input</span><span class="p">:</span>
 <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="mi">16</span> <span class="mi">17</span> <span class="mi">18</span> <span class="mi">19</span>
<span class="n">Even</span><span class="p">:</span> <span class="mi">0</span>  <span class="mi">2</span>  <span class="mi">4</span>  <span class="mi">6</span>  <span class="mi">8</span> <span class="mi">10</span> <span class="mi">12</span> <span class="mi">14</span> <span class="mi">16</span> <span class="mi">18</span>
</pre></div>
</div>
</div>
<div class="section" id="id49">
<h2>混淆<a class="headerlink" href="#id49" title="Permalink to this headline">¶</a></h2>
<p>在Eigen中，当变量同时出现在左值和右值，赋值操作可能会带来混淆问题。这一篇将解释什么是混淆，什么时候是有害的，怎么使用做。</p>
</div>
<div class="section" id="id50">
<h2>例子<a class="headerlink" href="#id50" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXi</span> <span class="n">mat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>   <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>   <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the matrix mat:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="o">//</span> <span class="n">This</span> <span class="n">assignment</span> <span class="n">shows</span> <span class="n">the</span> <span class="n">aliasing</span> <span class="n">problem</span>
<span class="n">mat</span><span class="o">.</span><span class="n">bottomRightCorner</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">topLeftCorner</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;After the assignment, mat = </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">matrix</span> <span class="n">mat</span><span class="p">:</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span>
<span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span>
<span class="n">After</span> <span class="n">the</span> <span class="n">assignment</span><span class="p">,</span> <span class="n">mat</span> <span class="o">=</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mi">4</span> <span class="mi">1</span> <span class="mi">2</span>
<span class="mi">7</span> <span class="mi">4</span> <span class="mi">1</span>
</pre></div>
</div>
<p>在 <code class="docutils literal notranslate"><span class="pre">mat.bottomRightCorner(2,2)</span> <span class="pre">=</span> <span class="pre">mat.topLeftCorner(2,2);</span></code> 赋值中展示了混淆。</p>
<p>mat(1,1) 在bottomRightCorner(2,2)和topLeftCorner(2,2)都存在。赋值结果中mat(2,2)本应该赋予操作前mat(1,1)的值=5。但是，最终程序结果mat(2,2)=1。原因是Eigen使用了lazy evaluation（懒惰评估），上面等价于</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>下面会解释如何通过eval()来解决这个问题。</p>
<p>混淆还会在缩小矩阵时出现，比如 <code class="docutils literal notranslate"><span class="pre">vec</span> <span class="pre">=</span> <span class="pre">vec.head(n)</span></code> 和 <code class="docutils literal notranslate"><span class="pre">mat</span> <span class="pre">=</span> <span class="pre">mat.block(i,j,r,c)</span></code>。</p>
<p>一般来说，混淆在编译阶段很难被检测到。比如第一个例子，如果mat再大一些可能就不会出现混淆了。但是Eigen可以在运行时检测某些混淆，如前面讲的例子。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Matrix2i a; a &lt;&lt; 1, 2, 3, 4;
cout &lt;&lt; &quot;Here is the matrix a:\n&quot; &lt;&lt; a &lt;&lt; endl;
a = a.transpose(); // !!! do NOT do this !!!
cout &lt;&lt; &quot;and the result of the aliasing effect:\n&quot; &lt;&lt; a &lt;&lt; endl;
Here is the matrix a:
1 2
3 4
and the result of the aliasing effect:
1 2
2 4
</pre></div>
</div>
<p>我们可以通过EIGEN_NO_DEBUG宏，在编译时关闭运行时的断言。</p>
</div>
<div class="section" id="id51">
<h2>解决混淆问题<a class="headerlink" href="#id51" title="Permalink to this headline">¶</a></h2>
<p>Eigen需要把右值赋值为一个临时matrix/array，然后再将临时值赋值给左值，便可以解决混淆。eval()函数实现了这个功能。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXi</span> <span class="n">mat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>   <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>   <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the matrix mat:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="o">//</span> <span class="n">The</span> <span class="nb">eval</span><span class="p">()</span> <span class="n">solves</span> <span class="n">the</span> <span class="n">aliasing</span> <span class="n">problem</span>
<span class="n">mat</span><span class="o">.</span><span class="n">bottomRightCorner</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">topLeftCorner</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">();</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;After the assignment, mat = </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">matrix</span> <span class="n">mat</span><span class="p">:</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span>
<span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span>
<span class="n">After</span> <span class="n">the</span> <span class="n">assignment</span><span class="p">,</span> <span class="n">mat</span> <span class="o">=</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mi">4</span> <span class="mi">1</span> <span class="mi">2</span>
<span class="mi">7</span> <span class="mi">4</span> <span class="mi">5</span>
</pre></div>
</div>
<p>同样： <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">a.transpose().eval();</span></code> ，当然我们最好使用 transposeInPlace()。如果存在xxxInPlace函数，推荐使用这类函数，它们更加清晰地标明了你在做什么。提供的这类函数：</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Origin</th>
<th>In-place</th>
</tr>
</thead>
<tbody>
<tr>
<td>MatrixBase::adjoint()</td>
<td>MatrixBase::adjointInPlace()</td>
</tr>
<tr>
<td>DenseBase::reverse()</td>
<td>DenseBase::reverseInPlace()</td>
</tr>
<tr>
<td>LDLT::solve()</td>
<td>LDLT::solveInPlace()</td>
</tr>
<tr>
<td>LLT::solve()</td>
<td>LLT::solveInPlace()</td>
</tr>
<tr>
<td>TriangularView::solve()</td>
<td>TriangularView::solveInPlace()</td>
</tr>
<tr>
<td>DenseBase::transpose()</td>
<td>DenseBase::transposeInPlace()</td>
</tr>
</tbody>
</table><p>而针对<code class="docutils literal notranslate"><span class="pre">vec</span> <span class="pre">=</span> <span class="pre">vec.head(n)</span></code>这种情况，推荐使用<code class="docutils literal notranslate"><span class="pre">conservativeResize()</span></code>。</p>
</div>
<div class="section" id="component">
<h2>混淆和component级的操作。<a class="headerlink" href="#component" title="Permalink to this headline">¶</a></h2>
<p>组件级是指整体的操作，比如matrix加法、scalar乘、array乘等，这类操作是安全的，不会出现混淆。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXf</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Here is the matrix mat:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">mat</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mat</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;After &#39;mat = 2 * mat&#39;, mat = </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span> <span class="o">-</span> <span class="n">MatrixXf</span><span class="p">::</span><span class="n">Identity</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;After the subtraction, it becomes</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mat</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">ArrayXXf</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">mat</span><span class="p">;</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">square</span><span class="p">();</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;After squaring, it becomes</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">arr</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">matrix</span> <span class="n">mat</span><span class="p">:</span>
<span class="mi">1</span> <span class="mi">2</span>
<span class="mi">4</span> <span class="mi">7</span>

<span class="n">After</span> <span class="s1">&#39;mat = 2 * mat&#39;</span><span class="p">,</span> <span class="n">mat</span> <span class="o">=</span>
 <span class="mi">2</span>  <span class="mi">4</span>
 <span class="mi">8</span> <span class="mi">14</span>

<span class="n">After</span> <span class="n">the</span> <span class="n">subtraction</span><span class="p">,</span> <span class="n">it</span> <span class="n">becomes</span>
 <span class="mi">1</span>  <span class="mi">4</span>
 <span class="mi">8</span> <span class="mi">13</span>

<span class="n">After</span> <span class="n">squaring</span><span class="p">,</span> <span class="n">it</span> <span class="n">becomes</span>
  <span class="mi">1</span>  <span class="mi">16</span>
 <span class="mi">64</span> <span class="mi">169</span>
</pre></div>
</div>
</div>
<div class="section" id="id52">
<h2>混淆和矩阵的乘法<a class="headerlink" href="#id52" title="Permalink to this headline">¶</a></h2>
<p>在Eigen中，矩阵的乘法一般都会出现混淆。除非是方阵（实质是元素级的乘）。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixXf</span> <span class="n">matA</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">matA</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">matA</span> <span class="o">=</span> <span class="n">matA</span> <span class="o">*</span> <span class="n">matA</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">matA</span><span class="p">;</span>

<span class="mi">4</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">4</span>
</pre></div>
</div>
<p>其他的操作，Eigen默认都是存在混淆的。所以Eigen对矩阵乘法自动引入了临时变量，对的<code class="docutils literal notranslate"><span class="pre">matA=matA*matA</span></code>这是必须的，但是对<code class="docutils literal notranslate"><span class="pre">matB=matA*matA</span></code>这样便是不必要的了。我们可以使用noalias()函数来声明这里没有混淆，matA*matA的结果可以直接赋值为matB。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">matB</span><span class="o">.</span><span class="n">noalias</span><span class="p">()</span> <span class="o">=</span> <span class="n">matA</span> <span class="o">*</span> <span class="n">matA</span><span class="p">;</span>
</pre></div>
</div>
<p>从Eigen3.3开始，如果目标矩阵resize且结果不直接赋值给目标矩阵，默认不存在混淆。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MatrixXf A(2,2), B(3,2);
B &lt;&lt; 2, 0,  0, 3, 1, 1;
A &lt;&lt; 2, 0, 0, -2;
A = (B * A).cwiseAbs();//cwiseAbs（）不直接赋给目标
//A = (B * A).eval().cwiseAbs()
cout &lt;&lt; A;
</pre></div>
</div>
<p>当然，对于任何混淆问题，都可以通过<code class="docutils literal notranslate"><span class="pre">matA=(matB*matA).eval()</span></code> 来解决。</p>
</div>
<div class="section" id="id53">
<h2>总结<a class="headerlink" href="#id53" title="Permalink to this headline">¶</a></h2>
<p>当相同的矩阵或array在等式左右都出现时，很容易出现混淆。</p>
<ol class="simple">
<li><p>compnent级别的操作不用考虑混淆。</p></li>
<li><p>矩阵相乘，Eigen默认会解决混淆问题，如果你确定不会出现混淆，可以使用noalias（）来提效。</p></li>
<li><p>混淆出现时，可以用eval()和xxxInPlace()函数解决。</p></li>
</ol>
</div>
<div class="section" id="id54">
<h2>存储顺序<a class="headerlink" href="#id54" title="Permalink to this headline">¶</a></h2>
<p>对于矩阵和二维数组有两种存储方式，列优先和行优先。</p>
<p>假设矩阵：</p>
<p><img alt="img" src="https://images2015.cnblogs.com/blog/532915/201701/532915-20170125204938597-130252060.png" /></p>
<p>按行优先存储，内存中形式如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">8</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">9</span> <span class="mi">9</span> <span class="mi">1</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">5</span>
</pre></div>
</div>
<p>列优先，内存格式：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">8</span> <span class="mi">9</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">9</span> <span class="mi">4</span> <span class="mi">5</span>
<span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ColMajor</span><span class="o">&gt;</span> <span class="n">Acolmajor</span><span class="p">;</span>
<span class="n">Acolmajor</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
             <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>
             <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;The matrix A:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Acolmajor</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;In memory (column-major):&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Acolmajor</span><span class="o">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="p">(</span><span class="n">Acolmajor</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;  &quot;</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">Matrix</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">RowMajor</span><span class="o">&gt;</span> <span class="n">Arowmajor</span> <span class="o">=</span> <span class="n">Acolmajor</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;In memory (row-major):&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Arowmajor</span><span class="o">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="p">(</span><span class="n">Arowmajor</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;  &quot;</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>输出</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">matrix</span> <span class="n">A</span><span class="p">:</span>
<span class="mi">8</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">9</span>
<span class="mi">9</span> <span class="mi">1</span> <span class="mi">4</span> <span class="mi">4</span>
<span class="mi">3</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">5</span>

<span class="n">In</span> <span class="n">memory</span> <span class="p">(</span><span class="n">column</span><span class="o">-</span><span class="n">major</span><span class="p">):</span>
<span class="mi">8</span>  <span class="mi">9</span>  <span class="mi">3</span>  <span class="mi">2</span>  <span class="mi">1</span>  <span class="mi">5</span>  <span class="mi">2</span>  <span class="mi">4</span>  <span class="mi">4</span>  <span class="mi">9</span>  <span class="mi">4</span>  <span class="mi">5</span>  

<span class="n">In</span> <span class="n">memory</span> <span class="p">(</span><span class="n">row</span><span class="o">-</span><span class="n">major</span><span class="p">):</span>
<span class="mi">8</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">1</span>  <span class="mi">4</span>  <span class="mi">4</span>  <span class="mi">3</span>  <span class="mi">5</span>  <span class="mi">4</span>  <span class="mi">5</span>
</pre></div>
</div>
<p>PlainObjectBase::data()函数可以返回矩阵中第一个元素的内存位置。</p>
</div>
<div class="section" id="id55">
<h2>存储顺序及选择<a class="headerlink" href="#id55" title="Permalink to this headline">¶</a></h2>
<p>Matrix类模板中可以设定存储的方向，RowMajor表示行优先，ColMajor表示列优先。默认是列优先。</p>
<p>如何选择存储方式呢？</p>
<ol class="simple">
<li><p>如果要和其他库合作开发，为了转化方便，可以选择同样的存储方式。</p></li>
<li><p>应用中涉及大量行遍历操作，应该选择行优先，寻址更快。反之亦然。</p></li>
<li><p>默认是列优先，而且大多库都是按照这个顺序的，默认的不失为较好的。</p></li>
</ol>
</div>
<div class="section" id="id56">
<h2>总结<a class="headerlink" href="#id56" title="Permalink to this headline">¶</a></h2>
<p>本来想春节前任务比较少，翻译完所有的Eigen系列的。但是我的目的是为了使用google的非线性优化库<a class="reference external" href="http://ceres-solver.org/installation.html#getting-the-source-code">ceres</a>，介绍了这些基本知识也够用了，如果遇到不清楚的函数可以直接到Eigen的官网查询。</p>
</div>
<div class="section" id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>https://www.cnblogs.com/houkai/p/6347408.html</p></li>
<li><p>https://www.cnblogs.com/houkai/p/6347648.html</p></li>
<li><p>https://www.cnblogs.com/houkai/p/6348044.html</p></li>
<li><p>https://www.cnblogs.com/houkai/p/6349970.html</p></li>
<li><p>https://www.cnblogs.com/houkai/p/6349974.html</p></li>
<li><p>https://www.cnblogs.com/houkai/p/6351358.html</p></li>
<li><p>https://www.cnblogs.com/houkai/p/6351609.html</p></li>
<li><p>https://www.cnblogs.com/houkai/p/6349981.html</p></li>
<li><p>https://www.cnblogs.com/houkai/p/6349988.html</p></li>
<li><p>https://www.cnblogs.com/houkai/p/6349990.html</p></li>
<li><p>https://www.cnblogs.com/houkai/p/6349991.html</p></li>
<li><p><a class="reference external" href="https://gist.github.com/gocarlos/c91237b02c120c6319612e42fa196d77#file-eigen-cheat-sheet"><strong>Eigen Cheat sheet</strong></a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="cuda.html" class="btn btn-neutral float-right" title="CUDA" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="hpc.html" class="btn btn-neutral float-left" title="HPC" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Hui Zhang.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>